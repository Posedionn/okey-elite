<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>101 Okey Plus Elite - Grid System</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    <style>
        :root {
            --plus-gold: #ffd700;
            --tile-bg: #fdfaf1;
            --grid-color: rgba(255, 255, 255, 0.15);
        }
        body { 
            background: #062a06 url('https://www.transparenttextures.com/patterns/dark-leather.png'); 
            color: white; font-family: 'Segoe UI', sans-serif; margin: 0; overflow: hidden;
        }

        /* Ãœst Bar */
        .top-nav {
            display: flex; justify-content: space-between; align-items: center;
            padding: 5px 15px; background: rgba(0,0,0,0.8); border-bottom: 2px solid var(--plus-gold);
        }

        /* OYUN ALANI VE IZGARA (GRID) */
        .game-area {
            height: 55vh; position: relative; overflow: hidden;
        }
        
        /* 101 Plus TarzÄ± Izgara Sistemi */
        .grid-layer {
            position: absolute; top: 10%; left: 5%; width: 90%; height: 60%;
            display: grid; grid-template-columns: repeat(20, 1fr); grid-template-rows: repeat(8, 1fr);
            border: 1px solid var(--grid-color);
            background-image: 
                linear-gradient(var(--grid-color) 1px, transparent 1px),
                linear-gradient(90deg, var(--grid-color) 1px, transparent 1px);
            background-size: 5% 12.5%; /* Izgara boyutlarÄ± */
        }

        /* TaÅŸ AÃ§ma AlanlarÄ± (KÄ±rmÄ±zÄ± Ã‡izgiyle AyrÄ±lmÄ±ÅŸ) */
        .drop-zone {
            position: absolute; top: 10%; left: 5%; width: 90%; height: 60%;
            display: flex; flex-wrap: wrap; align-content: flex-start; gap: 2px;
            z-index: 5;
        }

        /* Oyuncu Profilleri */
        .user-card {
            position: absolute; width: 70px; text-align: center; font-size: 11px;
            background: rgba(0,0,0,0.6); border-radius: 8px; padding: 5px; border: 1px solid #555;
        }
        .u-top { top: 5px; left: 50%; transform: translateX(-50%); }
        .u-left { top: 30%; left: 5px; }
        .u-right { top: 30%; right: 5px; }

        /* Plus TarzÄ± TaÅŸlar */
        .tile {
            width: 32px; height: 46px; background: var(--tile-bg);
            border-radius: 4px; display: flex; align-items: center; justify-content: center;
            font-weight: bold; font-size: 18px; color: #333;
            box-shadow: 0 4px 0 #bcbab0, 2px 4px 6px rgba(0,0,0,0.4);
        }
        .red { color: #d32f2f; } .blue { color: #1976d2; } .black { color: #111; } .orange { color: #ff8c00; }

        /* Istaka ve AkÄ±llÄ± Butonlar */
        .rack-wrapper {
            position: fixed; bottom: 70px; width: 100%; height: 110px;
            background: linear-gradient(to bottom, #4e342e, #2a1b15);
            border-top: 4px solid #1a100a; display: flex; flex-direction: column; justify-content: center;
        }
        .rack-row { display: flex; justify-content: center; gap: 4px; height: 48px; margin-bottom: 2px; }

        /* Buton Paneli */
        .footer-btns {
            position: fixed; bottom: 0; width: 100%; height: 70px;
            display: flex; justify-content: space-around; align-items: center;
            background: #000; padding: 5px; border-top: 2px solid #333;
        }
        .btn-plus {
            flex: 1; margin: 0 3px; height: 50px; border: none; border-radius: 6px;
            background: #222; color: var(--plus-gold); font-weight: bold; font-size: 11px;
        }
        .btn-side { width: 50px; background: #333; color: white; font-size: 10px; }
    </style>
</head>
<body>

    <div class="top-nav">
        <div id="timer" style="font-size: 20px; color: #ffeb3b; font-weight: bold;">45</div>
        <div style="font-size: 12px;">Puan: <span id="score" style="color:#4caf50">0</span></div>
    </div>

    <div class="game-area">
        <div class="grid-layer"></div> <div class="drop-zone" id="table-drop"></div> <div class="user-card u-top">ðŸ¤– Bilgisayar 1</div>
        <div class="user-card u-left">ðŸ¤– Bilgisayar 2</div>
        <div class="user-card u-right">ðŸ¤– Bilgisayar 3</div>

        <div style="position: absolute; top: 40%; left: 50%; transform: translate(-50%, -50%); display:flex; gap:15px; z-index: 10;">
            <div class="tile" style="background:#111; color:white; border:1px solid #444;">ðŸŽ´</div>
            <div class="tile">11</div>
        </div>
    </div>

    <div class="rack-wrapper">
        <div class="rack-row" id="r1"></div>
        <div class="rack-row" id="r2"></div>
    </div>

    <div class="footer-btns">
        <button class="btn-plus btn-side" onclick="akilliDiz('cift')">Ã‡Ä°FT<br>DÄ°Z</button>
        <button class="btn-plus" style="background: #2e7d32; color: white;" onclick="dagit()">DAÄžIT</button>
        <button class="btn-plus" style="background: #1565c0; color: white;" onclick="seriAc()">AÃ‡</button>
        <button class="btn-plus btn-side" onclick="akilliDiz('seri')">SERÄ°<br>DÄ°Z</button>
    </div>

    <script>
        const tg = window.Telegram.WebApp; tg.expand();
        const colors = ['red', 'blue', 'black', 'orange'];
        let deck = [];

        function dagit() {
            const r1 = document.getElementById('r1'); const r2 = document.getElementById('r2');
            r1.innerHTML = ''; r2.innerHTML = ''; deck = [];
            for(let i=0; i<22; i++) {
                const t = { n: Math.floor(Math.random()*13)+1, c: colors[Math.floor(Math.random()*4)] };
                deck.push(t);
                const html = `<div class="tile ${t.c}" data-n="${t.n}">${t.n}</div>`;
                if(i<11) r1.innerHTML += html; else r2.innerHTML += html;
            }
        }

        function akilliDiz(mod) {
            const r1 = document.getElementById('r1'); const r2 = document.getElementById('r2');
            r1.innerHTML = ''; r2.innerHTML = '';
            
            if(mod === 'seri') deck.sort((a,b) => a.n - b.n);
            else deck.sort((a,b) => a.c.localeCompare(b.c));

            deck.forEach((t, i) => {
                const html = `<div class="tile ${t.c}" data-n="${t.n}">${t.n}</div>`;
                if(i<11) r1.innerHTML += html; else r2.innerHTML += html;
            });
        }

        // SortableJS GruplarÄ±
        [document.getElementById('r1'), document.getElementById('r2'), document.getElementById('table-drop')].forEach(el => {
            new Sortable(el, { group: 'okey', animation: 150 });
        });

        window.onload = dagit;
    </script>
</body>
</html>